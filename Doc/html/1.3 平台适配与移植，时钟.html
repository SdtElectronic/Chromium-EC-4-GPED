
TIPS：本教程只针对STM32系列MCU范围内的适配和移植，不包括其他种类的MCU
<h2>平台适配与移植</h2>
    <h3>EC对STM32产品线的支持</h3>
    <ul>
        <li>截至本节更新上传时，EC已支持STM32的F0、F3、F4、F7、L1、L4、H7产品线</li>
        <li>EC对平台的支持大多都是 ，这意味着绝大多数情况下你都或多或少要根据自己的需要进行一些平台相关的配置</li>
    </ul>
    <h3>EC内部的平台适配机制</h3>
    <ul>
        <li>通过每个项目的build.mk文件中的CHIP_VARIANT声明平台。</li>
        <li>在\chip\stm32目录下，有不同平台的配置文件，以config-${platform}.h命名，如\chip\stm32\config-stm32f05x.h</li>
        <li>不需要为每个项目指定配置文件，只需要在项目的board.c中包含board_config.h</li>
        <li>make会自动根据CHIP_VARIANT包含对应平台的config文件。</li>
        <li>这意味着当你要创建一个EC未包含的新平台上的项目时，你需要写一个对应的config-${platform}.h放在\chip\stm32目录下</li>
        <li>当然这是遵循EC风格的做法，为了图方便你也可以将写好的包含了必要设定的config头文件直接包含进项目，或者直接在项目的头文件里配置设定</li>
    </ul>
    <h3>平台适配实际是做什么</h3>
    <ul>
        <li>当EC中没有针对你的项目使用的平台写好的config时，你需要根据平台特性自己写一个</li>
        <li>config文件几乎全部通过宏来进行设定</li>
        <li>常见的设定项目有：内核时钟，FLASH大小，IRQ数目等</li>

        <li>其中，时钟的概念稍显复杂，需要在下面单独的一段来解释</li>
    </ul>
    <h3>平台移植实际是做什么</h3>
    <ul>
        <li>平台移植是指把一个平台上的代码迁移到另一个不同平台上</li>
        <li>与适配不同，移植工作可能更加微妙，因为EC的抽象特性，大部分代码是可以不经修改直接重用的，你需要想到哪些平台相关的代码需要改动</li>
    </ul>

<h2>时钟</h2>
    时钟的概念在嵌入式控制器中是如此重要，以至于原本是作为基本概念的一部分却需要单独开一节来说。对于不熟悉计算机组成的读者来说，可以将时钟理解为有节奏的船工号子，而控制器上的各个组件就像是怠惰的纤夫，不听到这号令是绝不会工作半秒的。号令越急促，纤夫也就工作得越快。
    <h3>STM32时钟源</h3>
    <ul>
        <li></li>
    </ul>
    <h3>STM32时钟树，RCC</h3>
    <ul>
        <li>将源发生的时钟信号转换和配送到各个组件的机制被称为时钟树。控制这个机制的组件被称为RCC（Reset/Clock Controller，复位/时钟控制器）。</li>
        <li>STM32时钟树的结构如上图所示，</li>
        <li>SYSCLK是驱动绝大部分部件的时钟，可以是HSI, PLLCLK或HSE产生的，这几个源的切换由一个MUX控制</li>
        <li>HCLK是驱动高速组件（e.g. DMA控制器, RAM, etc.）的时钟，由SYSCLK经AHB预分频产生</li>
        <li>FCLK是内核的工作时钟，和HCLK同步（注意它不是HCLK产生的，HCLK停止时它仍然工作），可以类比为CPU的主频。</li>
        <li>PCLK是驱动低速外设（e.g. I2C, SPI, etc.）的时钟，由HCLK经APB预分频产生，有关配置低速外设时钟的操作在外设的章节里介绍</li>
        <li>LSI, LSE的时钟信号仅能用于驱动IWDG和RTC，不能产生系统时钟。有关IWDG和RTC的操作在外设的章节里介绍</li>
    </ul>
    <h3>EC对时钟配置的封装</h3>
    <ul>
        <li>虽然STM32的时钟系统非常复杂，但EC提供的高层封装的接口使我们的操作实际上很简单</li>
        <li>EC使用PLLCLK作为系统时钟源，默认由HSI产生</li>
        <li>若要使用HSE作为PLLCLK的输入，需要添加 宏，并通过 宏告知HSE的频率</li>
        <li>EC暴露的PLLCLK接口只有三个分频系数，</li>
        <li>系统时钟（内核主频）的计算公式是 ，尽管最后只要获得期望的输出频率即可，但出于稳定性的考虑最好不要将某一系数设得过高，更不能让内核主频高于平台的限制</li>
    </ul>
    <h3>EC系统时钟配置实例</h3>

    <h2>平台适配与移植实例</h2>